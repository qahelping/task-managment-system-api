<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="../../assets/favicon.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal inside portal + aria-hidden - Web Automation Torture Lab</title>
        <!-- –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã/–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ -->
    <link rel="stylesheet" href="../../assets/indigo-styles.css"/>

    <!-- –§–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã: –ø–µ—Ä–µ–ª–∏–≤—ã/–≤–æ–ª–Ω—ã/–∞—É—Ä–∞/–∑–≤—ë–∑–¥—ã (–ø–æ–¥–∫–ª—é—á–∞—Ç—å –ü–û–°–õ–ï –±–∞–∑–æ–≤—ã—Ö) -->
    <link rel="stylesheet" href="../../assets/aurora.css"/>
    <style>
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }
        .modal-content {
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 16px;
            max-width: 500px;
            box-shadow: var(--shadow-glow);
        }
    </style>
</head>
<body data-style="s2">
<!-- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–∏ –¥–ª—è –∑–≤—ë–∑–¥ -->
<div class="sky" aria-hidden="true"></div>
<div class="layout">
        <header class="header">
            <div class="header-content">
                <div class="brand">
                <div class="brand-mark"><img src="../../assets/logo.png" alt="Logo" class="brand-logo-img"></div>
                <div class="brand-text">
                    <div class="brand-title">Web Automation Torture Lab</div>
                </div>
            </div>
                <button class="theme-toggle" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
        </header>

        

        <main class="main">
            <div class="container">
                <a href="../overlays.html" class="back-link">–ù–∞–∑–∞–¥</a>
                <div class="page-header">
                    <a href="../overlays.html" class="nav-link" style="display: inline-block; margin-bottom: 1rem; text-decoration: none;">‚Üê –ù–∞–∑–∞–¥ –∫ Modals, Toasts, Sticky</a>
                    <h2 class="page-title">Modal inside portal + aria-hidden</h2>
                    <p class="page-description">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: Modals, Toasts, Sticky</p>
                </div>

                <div class="stress-controls">
                    <button class="stress-btn" id="stressToggle">Toggle Stress Mode</button>
                </div>

                <div class="case-card" style="max-width: 1000px; margin: 0 auto;">
                    <h3 class="case-title">Modal inside portal + aria-hidden</h3>
                    
                    <div class="case-element" id="case-element">
                        <button id="open-modal-btn" style="padding: 1rem 2rem; background: var(--accent-primary); color: white; border: none; border-radius: 8px;">Open Modal</button>
                        <div id="modal-backdrop" class="modal-backdrop hidden">
                            <div class="modal-content" role="dialog">
                                <h3>Modal Title</h3>
                                <p>This modal is rendered in a portal</p>
                                <button id="close-modal-btn" style="margin-top: 1rem; padding: 0.5rem 1rem; background: var(--accent-primary); color: white; border: none; border-radius: 8px;">Close</button>
                            </div>
                        </div>
                    </div>

                    <div class="problem-section">
                        <span class="section-label problem-label">Problem</span>
                        <div class="section-content">
                            –ú–æ–¥–∞–ª–∫–∞ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü body, background –ø–æ–ª—É—á–∞–µ—Ç aria-hidden. –õ–æ–∫–∞—Ç–æ—Ä—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç; backdrop intercept.
                        </div>
                    </div>

                    <div class="problem-section">
                        <span class="section-label why-label">Why it happens</span>
                        <div class="section-content">
                            Portal —Ä–µ–Ω–¥–µ—Ä–∏—Ç –º–æ–¥–∞–ª–∫—É –≤–Ω–µ DOM-–¥–µ—Ä–µ–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. aria-hidden –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã.
                        </div>
                    </div>

                    <div class="show-solution-wrapper">
                        <input type="text" class="solution-key-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ—à–µ–Ω–∏—è">
                        <button class="show-solution-btn" disabled>–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ</button>
                    </div>

                    <div class="solution-section solution-hidden">
                        <span class="section-label solution-label">Solution: Selenium (Python)</span>
                        <div class="code-wrapper">
                            <div class="code-header">
                                <span class="code-label">Selenium (Python)</span>
                                <button class="copy-btn" onclick="copyToClipboard(`from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# 1. –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
open_btn = driver.find_element(By.ID, 'open-modal-btn')
open_btn.click()

# 2. –ò—â–µ–º –º–æ–¥–∞–ª–∫—É –≤ body (portal)
WebDriverWait(driver, 10).until(
    EC.presence_of_element_located((By.CLASS_NAME, 'modal-content'))
)

# 3. –ö–ª–∏–∫–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª–∫–∏
close_btn = driver.find_element(By.ID, 'close-modal-btn')
close_btn.click()`, this)">Copy</button>
                            </div>
                            <pre class="code-block">from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# 1. –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
open_btn = driver.find_element(By.ID, 'open-modal-btn')
open_btn.click()

# 2. –ò—â–µ–º –º–æ–¥–∞–ª–∫—É –≤ body (portal)
WebDriverWait(driver, 10).until(
    EC.presence_of_element_located((By.CLASS_NAME, 'modal-content'))
)

# 3. –ö–ª–∏–∫–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª–∫–∏
close_btn = driver.find_element(By.ID, 'close-modal-btn')
close_btn.click()</pre>
                        </div>
                    </div>

                    <div class="solution-section solution-hidden">
                        <span class="section-label solution-label">Solution: Playwright (TypeScript)</span>
                        <div class="code-wrapper">
                            <div class="code-header">
                                <span class="code-label">Playwright (TypeScript)</span>
                                <button class="copy-btn" onclick="copyToClipboard(`// –ò—Å–ø–æ–ª—å–∑—É–µ–º getByRole –¥–ª—è –ø–æ–∏—Å–∫–∞ dialog
await page.getByRole('button', { name: 'Open Modal' }).click();

const modal = page.getByRole('dialog');
await expect(modal).toBeVisible();

// –ö–ª–∏–∫–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ dialog
await modal.getByRole('button', { name: 'Close' }).click();`, this)">Copy</button>
                            </div>
                            <pre class="code-block">// –ò—Å–ø–æ–ª—å–∑—É–µ–º getByRole –¥–ª—è –ø–æ–∏—Å–∫–∞ dialog
await page.getByRole('button', { name: 'Open Modal' }).click();

const modal = page.getByRole('dialog');
await expect(modal).toBeVisible();

// –ö–ª–∏–∫–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ dialog
await modal.getByRole('button', { name: 'Close' }).click();</pre>
                        </div>
                    </div>

                    <button class="trigger-btn" onclick="triggerCase()">Trigger</button>

                    <div class="assert-section solution-hidden">
                        <div class="assert-title">How to assert it's fixed:</div>
                        <p>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–æ–¥–∞–ª–∫–∞ –æ—Ç–∫—Ä—ã–ª–∞—Å—å –∏ –∑–∞–∫—Ä—ã–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ</p>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>Web Automation Torture Lab ¬© <span id="currentYear">2024</span> | –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
        </footer>
    </div>





    <script src="../../assets/highlight.js"></script>
    <script src="../../assets/app.js"></script>
    <script>
        // Case-specific handler
        function triggerCase() {
            const openBtn = document.getElementById('open-modal-btn');
            const backdrop = document.getElementById('modal-backdrop');
            const closeBtn = document.getElementById('close-modal-btn');
            
            openBtn.addEventListener('click', () => {
                backdrop.classList.remove('hidden');
                // –°–∏–º—É–ª–∏—Ä—É–µ–º portal - –ø–µ—Ä–µ–º–µ—â–∞–µ–º –≤ –∫–æ–Ω–µ—Ü body
                if (!document.body.contains(backdrop)) {
                    document.body.appendChild(backdrop);
                }
                // –î–æ–±–∞–≤–ª—è–µ–º aria-hidden –Ω–∞ body
                document.body.setAttribute('aria-hidden', 'true');
            }, { once: true });
            
            closeBtn.addEventListener('click', () => {
                backdrop.classList.add('hidden');
                document.body.removeAttribute('aria-hidden');
            });
            
            openBtn.click();
        }

        // Stress mode toggle
        document.getElementById('stressToggle')?.addEventListener('click', function() {
            window.stressMode.toggle();
            this.classList.toggle('active');
            this.textContent = window.stressMode.enabled ? 'Stress Mode: ON' : 'Stress Mode: OFF';
        });
    </script>
</body>
</html>

